<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="author" content="Thomas Prochazka"/><meta name="description" content="A little Software Engineering Blog by Thomas Prochazka, filled with posts regarding engineering problems and solutions"/><meta name="keywords" content="Software Engineer, Software Development, Blog"/><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><link rel="icon" href="/favicon.ico" type="image/x-icon"/><link rel="alternate" type="application/atom+xml" title="Software Engineering by Thomas Prochazka" href="/feed.xml"/><title>Deferred VWO and the white flash</title><meta property="og:title" content="Deferred VWO and the white flash"/><meta property="og:description" content="Deferred VWO will cause a white flash"/><meta property="og:image" content="https://www.gravatar.com/avatar/52a73317cd435a835d6cc927959f988c"/><meta property="og:url" content="https://zlypher.github.io/posts/defer-vwo-white-flash"/><meta name="twitter:card" content="summary"/><meta property="og:site_name" content="Software Engineering by Thomas Prochazka"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/5226afd6138f5907.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5226afd6138f5907.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-fd82975a6094609f.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-c586b89e07064d4a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6c2c0e783cd392ad.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-13c2a770013f443c.js" defer=""></script><script src="/_next/static/uunYJl809R2NBnTtH6csA/_buildManifest.js" defer=""></script><script src="/_next/static/uunYJl809R2NBnTtH6csA/_ssgManifest.js" defer=""></script><script src="/_next/static/uunYJl809R2NBnTtH6csA/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><svg xmlns="http://www.w3.org/2000/svg" style="display:none"><symbol id="icon-linked" viewBox="0 0 16 16" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51v1.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z"></path></symbol><symbol id="icon-github" viewBox="0 0 24 24" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></symbol><symbol id="icon-twitter" viewBox="0 0 16 16" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.37-1.337.64-2.085.79-.598-.64-1.45-1.04-2.396-1.04-1.812 0-3.282 1.47-3.282 3.28 0 .26.03.51.085.75-2.728-.13-5.147-1.44-6.766-3.42C.83 2.58.67 3.14.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.41-.02-.61-.058.42 1.304 1.63 2.253 3.07 2.28-1.12.88-2.54 1.404-4.07 1.404-.26 0-.52-.015-.78-.045 1.46.93 3.18 1.474 5.04 1.474 6.04 0 9.34-5 9.34-9.33 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7z"></path></symbol><symbol id="icon-facebook" viewBox="0 0 16 16" fill-rule="evenodd"><path d="M10.28 14V9.35h1.56l.23-1.8h-1.79V6.38c0-.53.15-.89.9-.89h.96V3.88c-.17-.02-.74-.07-1.4-.07-1.38 0-2.33.85-2.33 2.4v1.33H6.85v1.81H8.4V14H2.66a.66.66 0 0 1-.66-.66V2.66c0-.36.3-.66.66-.66h10.68c.36 0 .66.3.66.66v10.68c0 .36-.3.66-.66.66h-3.06z"></path></symbol></svg><div class="o-page-wrapper"><nav class="c-menu"><ul class="c-menu__list"><li class="c-menu__list-item"><a class="c-menu__link" href="/">Posts</a></li><li class="c-menu__list-item"><a class="c-menu__link" href="/talks">Talks</a></li><li class="c-menu__list-item"><a class="c-menu__link" href="/about">About Me</a></li></ul></nav><main class="o-main"><article class="c-post" itemscope="" itemType="http://schema.org/BlogPosting"><header class="c-post__header"><time class="c-post__date" dateTime="2017-10-28T17:14:00.000Z" itemProp="datePublished">October 28, 2017</time><h1 class="c-post__title" itemProp="name headline">Deferred VWO and the white flash</h1></header><div class="c-post__content" itemProp="articleBody"><div><p>A few days ago, one of our Testers found a strange behaviour on our website. The website loads initially, has its first paint and suddenly turns white for a fraction of a second and then displays everything correctly.</p>
<p>So let's see if we can find out, what's going on. First step: Clone current stable version locally and try to reproduce the problem. Thankfully, it occurs on the local machine as well. And just to make sure, the bug also occurs on other browsers than Chrome.</p>
<p>First general idea: Load the website, open dev tools and check the console. One message seems rather close to the occurence of the phenomenon:</p>
<pre><code>GET https://dev.visualwebsiteoptimizer.com/j.php?a=52337&#x26;u=XXX&#x26;r=0.8674099101753603 net::ERR_BLOCKED_BY_CLIENT
</code></pre>
<p>Well <a href="https://chrome.google.com/webstore/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm?hl=de">uBlock Origins</a>{:target="_blank" rel="noopener noreferrer"} blocks the loading of <a href="https://vwo.com/">Visual Website Optimizer</a>{:target="_blank" rel="noopener noreferrer"}, but that can't be the problem, right? Let's remove the line and check again. And sure enough, the white flash is gone...</p>
<p>As it turns out, in a previous attempt to make the site loading more efficient, the VWO snippet was extracted into a separate js file and loaded with the "defer" attribute.</p>
<p>By removing the "defer" attribute, everything seems the be working again whithout a white flash.</p>
<p>I'm not sure what the VWO script is doing, but everything seems to work fine for now. However, it would be interesting to dig deeper into the actual behaviour of the VWO script.</p>
</div></div><footer><div class="c-post__share"><a class="c-post__share-link" target="blank" href="https://twitter.com/intent/tweet?text=Deferred%20VWO%20and%20the%20white%20flash%20https://zlypher.github.io/posts/defer-vwo-white-flash"><span class="u-sr-only">Share via Twitter</span><svg class="c-post__share-icon"><use xlink:href="#icon-twitter"></use></svg></a><a class="c-post__share-link" target="blank" href="http://www.facebook.com/sharer/sharer.php?u=https://zlypher.github.io/posts/defer-vwo-white-flash&amp;title=Deferred%20VWO%20and%20the%20white%20flash"><span class="u-sr-only">Share via Facebook</span><svg class="c-post__share-icon"><use xlink:href="#icon-facebook"></use></svg></a></div><p class="c-post__info">Please let me know if you have any suggestions or corrections to improve this post. Feedback is always appreciated.</p></footer></article></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"layout":"post","title":"Deferred VWO and the white flash","description":"Deferred VWO will cause a white flash","date":"2017-10-28 18:14:00 +0100","slug":"defer-vwo-white-flash","content":"\u003cp\u003eA few days ago, one of our Testers found a strange behaviour on our website. The website loads initially, has its first paint and suddenly turns white for a fraction of a second and then displays everything correctly.\u003c/p\u003e\n\u003cp\u003eSo let's see if we can find out, what's going on. First step: Clone current stable version locally and try to reproduce the problem. Thankfully, it occurs on the local machine as well. And just to make sure, the bug also occurs on other browsers than Chrome.\u003c/p\u003e\n\u003cp\u003eFirst general idea: Load the website, open dev tools and check the console. One message seems rather close to the occurence of the phenomenon:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eGET https://dev.visualwebsiteoptimizer.com/j.php?a=52337\u0026#x26;u=XXX\u0026#x26;r=0.8674099101753603 net::ERR_BLOCKED_BY_CLIENT\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWell \u003ca href=\"https://chrome.google.com/webstore/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm?hl=de\"\u003euBlock Origins\u003c/a\u003e{:target=\"_blank\" rel=\"noopener noreferrer\"} blocks the loading of \u003ca href=\"https://vwo.com/\"\u003eVisual Website Optimizer\u003c/a\u003e{:target=\"_blank\" rel=\"noopener noreferrer\"}, but that can't be the problem, right? Let's remove the line and check again. And sure enough, the white flash is gone...\u003c/p\u003e\n\u003cp\u003eAs it turns out, in a previous attempt to make the site loading more efficient, the VWO snippet was extracted into a separate js file and loaded with the \"defer\" attribute.\u003c/p\u003e\n\u003cp\u003eBy removing the \"defer\" attribute, everything seems the be working again whithout a white flash.\u003c/p\u003e\n\u003cp\u003eI'm not sure what the VWO script is doing, but everything seems to work fine for now. However, it would be interesting to dig deeper into the actual behaviour of the VWO script.\u003c/p\u003e\n","url":"https://zlypher.github.io/posts/defer-vwo-white-flash"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"defer-vwo-white-flash"},"buildId":"uunYJl809R2NBnTtH6csA","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>